<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Debug Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px; 
        }
        .test-section { 
            margin: 20px 0; 
            padding: 15px; 
            border: 1px solid #ddd; 
            border-radius: 5px;
        }
        button { 
            background: #2563eb; 
            color: white; 
            border: none; 
            padding: 10px 20px; 
            border-radius: 5px; 
            cursor: pointer; 
            margin: 5px;
        }
        .result { 
            margin-top: 10px; 
            padding: 10px; 
            border-radius: 5px; 
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success { background: #dcfce7; color: #166534; }
        .error { background: #fef2f2; color: #dc2626; }
        input { 
            margin: 5px; 
            padding: 8px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }
    </style>
</head>
<body>
    <h1>ðŸ”§ Registration Debug Test</h1>
    
    <div class="test-section">
        <h3>Manual Registration Test</h3>
        <input type="text" id="name" placeholder="Name" value="Test User">
        <input type="email" id="email" placeholder="Email" value="test@example.com">
        <input type="password" id="password" placeholder="Password" value="password123">
        <br>
        <button onclick="testManualRegister()">Test Registration</button>
        <button onclick="testSimpleRegister()">Test Simple Data</button>
        <button onclick="testRegisterTest()">Test Register-Test Endpoint</button>
        <div id="result" class="result"></div>
    </div>

    <script>
        const API_BASE = window.location.origin;

        async function testManualRegister() {
            const result = document.getElementById('result');
            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            const payload = { name, email, password };
            
            result.textContent = `Sending to ${API_BASE}/api/register:\n${JSON.stringify(payload, null, 2)}\n\nWaiting for response...`;
            
            try {
                const response = await fetch(`${API_BASE}/api/register`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                
                result.className = response.ok ? 'result success' : 'result error';
                result.textContent = `Status: ${response.status}\nResponse:\n${JSON.stringify(data, null, 2)}`;
                
            } catch (error) {
                result.className = 'result error';
                result.textContent = `Network Error: ${error.message}`;
            }
        }

        async function testSimpleRegister() {
            const result = document.getElementById('result');
            const payload = { 
                name: "Test", 
                email: "test@test.com", 
                password: "123" 
            };
            
            result.textContent = `Sending minimal data:\n${JSON.stringify(payload, null, 2)}\n\nWaiting...`;
            
            try {
                const response = await fetch(`${API_BASE}/api/register`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                result.className = response.ok ? 'result success' : 'result error';
                result.textContent = `Status: ${response.status}\nResponse:\n${JSON.stringify(data, null, 2)}`;
                
            } catch (error) {
                result.className = 'result error';
                result.textContent = `Error: ${error.message}`;
            }
        }

        async function testRegisterTest() {
            const result = document.getElementById('result');
            const payload = { name: "Test", email: "test@test.com", password: "123" };
            
            try {
                const response = await fetch(`${API_BASE}/api/register-test`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                const data = await response.json();
                result.className = response.ok ? 'result success' : 'result error';
                result.textContent = `Test Endpoint Status: ${response.status}\nResponse:\n${JSON.stringify(data, null, 2)}`;
                
            } catch (error) {
                result.className = 'result error';
                result.textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
